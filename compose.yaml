name: papercut

services:
  papercut:
    image: papercut:latest
    environment:
      - LINEAR_SIGNING_SECRET=${LINEAR_SIGNING_SECRET}
      - PRINTER_USB_VENDOR_ID=${PRINTER_USB_VENDOR_ID}
      - PRINTER_USB_PRODUCT_ID=${PRINTER_USB_PRODUCT_ID}
      - PRINTER_CHAR_WIDTH=${PRINTER_CHAR_WIDTH}
      - COMPANY_LOGO_PATH=${COMPANY_LOGO_PATH}
      - COMPANY_NAME=${COMPANY_NAME}
      - COMPANY_ADDRESS_LINE1=${COMPANY_ADDRESS_LINE1}
      - COMPANY_ADDRESS_LINE2=${COMPANY_ADDRESS_LINE2}
      - COMPANY_PHONE=${COMPANY_PHONE}
      - COMPANY_URL=${COMPANY_URL}
      - COMPANY_TAGLINE=${COMPANY_TAGLINE}
    volumes:
      - /dev/bus/usb:/dev/bus/usb:ro
      - ./assets:/app/assets:ro
    # Grant full access to USB devices (required for printer communication)
    privileged: true
    restart: unless-stopped

  cloudflared:
    image: docker.io/cloudflare/cloudflared:2025.6.1
    command: tunnel --no-autoupdate run
    environment:
      - TUNNEL_TOKEN=${TUNNEL_TOKEN}
    restart: unless-stopped
